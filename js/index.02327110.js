(function(e){function t(t){for(var n,s,c=t[0],i=t[1],u=t[2],d=0,p=[];d<c.length;d++)s=c[d],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&p.push(a[s][0]),a[s]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);l&&l(t);while(p.length)p.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,c=1;c<r.length;c++){var i=r[c];0!==a[i]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},a={index:0},o=[];function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=i;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},16:function(e,t){},17:function(e,t){},18:function(e,t){},19:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",{attrs:{id:"inspire"}},[r("v-container",[r("app-menu"),r("v-app-bar",{attrs:{app:"","clipped-left":"",flat:"",color:"primary lighten-2"}},[r("v-toolbar-title",{staticClass:"white--text"},[e._v("Administration of bond register")]),r("v-spacer"),e.wallet?r("v-chip",{staticClass:"ma-2",attrs:{close:"",color:"blue","text-color":"white"},on:{"click:close":e.disconnect}},[e._v(" "+e._s(e.wallet)+" ")]):e._e()],1),r("v-main",[r("v-container",{staticClass:"py-8"},[r("router-view")],1)],1)],1),r("v-overlay",{attrs:{value:e.mmIsOpen}},[r("v-progress-circular",{attrs:{indeterminate:""}})],1),r("v-snackbar",{attrs:{"multi-line":"",color:e.snackbarColor,right:""},model:{value:e.displaySnackbar,callback:function(t){e.displaySnackbar=t},expression:"displaySnackbar"}},[e._v(" "+e._s(e.snackbarMessage)+" ")]),r("wallet-authentication-dialog",{ref:"walletAuthenticationDialog"})],1)},o=[],s=r("5530"),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-navigation-drawer",{attrs:{app:"",clipped:"",flat:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[r("v-divider"),r("v-list",[r("v-list-item-group",{attrs:{value:e.$route.name,mandatory:"",color:"primary"}},[e._l(e.sidenav,(function(t,n){var a=t.icon,o=t.label,s=t.route,c=t.disabled,i=t.subheader;return[i&&""!==o&&0!==n?r("v-divider",{key:o+"-divider"}):e._e(),i&&""!==o?r("v-subheader",{key:o},[e._v(e._s(o))]):r("v-list-item",{key:s,attrs:{value:s,disabled:c(),link:""},on:{click:function(t){return e.goTo(s)}}},[r("v-list-item-icon",[r("v-icon",[e._v(e._s(a))])],1),r("v-list-item-content",[r("v-list-item-title",[e._v(e._s(o))])],1)],1)]}))],2)],1)],1)},i=[],u=r("b85c"),l=(r("d81d"),r("4de4"),r("d3b7"),r("b0c0"),r("fb6a"),r("caad"),r("7ffd")),d=r("8c4f"),p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._v("Install MetaMask and then reload this application.")])},f=[],h={},v=h,m=r("2877"),w=Object(m["a"])(v,p,f,!1,null,null,null),b=w.exports,g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.hasProviderMetamask?r("v-btn",{attrs:{color:"primary",dark:""},on:{click:e.openMetaMaskConnectionDialog}},[e._v("Connect Metamask Wallet")]):e._e(),r("br"),r("br"),e.hasProviderDirect?r("div",[r("v-btn",{attrs:{color:"primary",dark:""},on:{click:e.prepareOpenWeb3DirectConnectionDialog}},[e._v("Connect with below configuration")]),e._v(" "),r("br"),r("br"),r("v-select",{attrs:{hint:"node: "+e.selectedNetwork.nodeUrl+"; custody: "+e.selectedNetwork.walletCustodyAPIBaseUrl,items:e.networks,"item-text":"name","item-value":"nodeUrl","persistent-hint":"","return-object":"","single-line":""},model:{value:e.selectedNetwork,callback:function(t){e.selectedNetwork=t},expression:"selectedNetwork"}}),e.hasCustodyApi?r("div",[r("br"),r("v-combobox",{attrs:{label:"Enter the wallet address",placeholder:"capture your wallet address",outlined:"",counter:"",clearable:"","search-input":e.wallet,items:e.wallets},on:{"update:search-input":e.updateWallet}}),r("v-text-field",{attrs:{label:"Enter the wallet password",placeholder:"capture your wallet password",outlined:"",type:e.show?"text":"password"},on:{"click:append":function(t){e.show=!e.show}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1):e._e()],1):e._e()],1)},k=[],x=r("1da1"),y=(r("96cf"),r("33d1"),r("ea98"),r("d9e2"),r("99af"),r("ac1f"),r("1276"),r("e9c4"),r("a15b"),r("a434"),r("99e5")),R=r.n(y),O=r("cde1"),j=r("a086"),A=r("602f"),C=r("4085"),_=r.n(C),M=(r("4dd0c"),r("3ca3"),r("ddb0"),r("2b3d"),r("9861"),r("2f62")),I=l["b"];l["b"].options.mapping="simple";r("8a79"),r("2532"),r("7db0");function S(e,t){if(t&&!Array.isArray(t)&&(t=[t]),t&&(t=t.map((function(e){return(e.endsWith(":")?e:e+":").toLowerCase()}))),e)try{var r=new URL(e);if(t&&!t.includes(r.protocol))return;return r}catch(n){return}}function U(e){return P.apply(this,arguments)}function P(){return P=Object(x["a"])(regeneratorRuntime.mark((function e(t){var r,n,a,o,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(n in Array.isArray(t.networks)||(t.networks=[]),r=t.explorers||{},r)a=r[n],S(a,["http","https"])||delete r[n];t.explorers=r,o=Object(u["a"])(t.networks);try{for(o.s();!(s=o.n()).done;)c=s.value,S(c.nodeUrl,["http","https","ws","wss"])||delete c.nodeUrl,S(c.walletCustodyAPIBaseUrl,["http","https"])||delete c.walletCustodyAPIBaseUrl,S(c.explorerUrl,["http","https"])||delete c.explorerUrl,c.explorerUrl||t.explorers[c.chainID]&&(c.explorerUrl=t.explorers[c.chainID])}catch(i){o.e(i)}finally{o.f()}return 0==t.networks.length&&t.networks.push({name:"No network defined in the configuration"}),e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)}))),P.apply(this,arguments)}function D(e){var t=e.networks.find((function(e){return e.default}));return!t&&e.networks.length>0&&(t=e.networks[0]),t}function W(e,t){var r,n=Object(u["a"])(e.networks);try{for(n.s();!(r=n.n()).done;){var a=r.value;a.nodeUrl==t?a.default=!0:a.default=!1}}catch(o){n.e(o)}finally{n.f()}return e}function N(e){return e.networks}function E(e,t){if(e)if(t){if(e.explorers[t])return e.explorers[t]}else{var r=D(e);if(r)return r.explorerUrl}}r("25eb"),r("a9e3");var B=r("4c41"),T=r.n(B),F=function(){return{provider:null,providerMetamask:null,providerDirect:null,providerModel:null,custodyModel:null,custodyApiUrl:null,wallet:null,contract:null,registered:!1,isNode:!1,isVoterNode:!1,isAuditor:!1,isAuditorApproved:!1,walletAuthenticationFunction:null}},$={explorerUrl:function(e){return"metamask"==e.providerModel?e.providerMetamask.explorerUrl:"direct"==e.providerModel?e.providerDirect.explorerUrl:void 0}},L=l["d"].mutations(F);function K(){return V.apply(this,arguments)}function V(){return V=Object(x["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=Ae.get("config"),e.next=3,T()();case 3:if(r=e.sent,!r){e.next=14;break}return r.on("connect",(function(e){console.log("Metamask chain info",e)})),r.on("accountsChanged",(function(){return window.location.reload()})),n=new R.a(r),e.next=10,n.eth.getChainId();case 10:return a=e.sent,e.abrupt("return",{providerModel:"metamask",provider:r,custodyModel:"metamask",custodyApiUrl:null,chainID:a,explorerUrl:E(t,a)});case 14:return e.abrupt("return",void 0);case 15:case"end":return e.stop()}}),e)}))),V.apply(this,arguments)}function z(){return J.apply(this,arguments)}function J(){return J=Object(x["a"])(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=Ae.get("config"),r=D(t),!r.nodeUrl){e.next=8;break}return n={providerModel:"direct",provider:Se(r.nodeUrl),custodyModel:null,custodyApiUrl:null,chainID:Number.parseInt(r.chainID),explorerUrl:E(t)},r.walletCustodyAPIBaseUrl?(n.custodyModel="api",n.custodyApiUrl=r.walletCustodyAPIBaseUrl):console.log("Note: No company's wallet custody configured"),e.abrupt("return",n);case 8:return console.log("Note: No direct web3 access configured"),e.abrupt("return",void 0);case 10:case"end":return e.stop()}}),e)}))),J.apply(this,arguments)}var G={fetchRole:function(){return Object(x["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("fetchRole called"),Ae.set("auth/isAuditor",!1),Ae.set("auth/isNode",!1),Ae.set("auth/isVoterNode",!1),t=Ae.get("auth/wallet"),console.log("Fetch role of ",t),e.next=8,Ae.dispatch("connected");case 8:case"end":return e.stop()}}),e)})))()},detectProvider:function(){return Object(x["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("Before detecting providers"),e.prev=1,e.next=4,Ae.dispatch("fetchConfig");case 4:return t=0,e.next=7,K();case 7:return r=e.sent,r&&t++,e.next=11,z();case 11:if(n=e.sent,n&&t++,0!=t){e.next=15;break}return e.abrupt("return");case 15:Ae.set("auth/providerMetamask",r),Ae.set("auth/providerDirect",n),t>1?Ae.set("auth/providerModel","both"):(a=n||r,Ae.set("auth/provider",a.provider),Ae.set("auth/providerModel",a.providerModel)),e.next=23;break;case 20:e.prev=20,e.t0=e["catch"](1),console.error("Fail detecting a valid provider",e.t0.message);case 23:case"end":return e.stop()}}),e,null,[[1,20]])})))()},attemptToConnectWallet:function(){return Object(x["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=[],r=Ae.get("auth/providerMetamask"),n=Ae.get("auth/providerDirect"),!r){e.next=7;break}return e.next=6,window.ethereum.request({method:"eth_accounts"});case 6:t=e.sent;case 7:if(!n||0!=t.length){e.next=11;break}return e.next=10,$e();case 10:t=e.sent;case 11:if(console.log("attemptToConnectWallet",t),a=t.length>0?t[0]:null,a){e.next=15;break}return e.abrupt("return");case 15:return Ae.set("auth/wallet",a),e.abrupt("return",a);case 17:case"end":return e.stop()}}),e)})))()},openMetaMaskConnectionDialog:function(e){return Object(x["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,Ae.set("auth/wallet",null),t.next=4,window.ethereum.request({method:"eth_requestAccounts"});case 4:if(n=t.sent,0!==n.length){t.next=7;break}return t.abrupt("return");case 7:return Ae.set("auth/wallet",n[0]),a=Ae.get("auth/providerMetamask"),Ae.set("auth/provider",a.provider),Ae.set("auth/providerModel",a.providerModel),t.next=13,r("fetchRole");case 13:Ot.push({name:"register"});case 14:case"end":return t.stop()}}),t)})))()},openWeb3DirectConnectionDialog:function(e,t){return Object(x["a"])(regeneratorRuntime.mark((function r(){var n,a,o,s,c,i,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.dispatch,a=t.wallet,o=t.password,s=t.nodeUrl,Ae.set("auth/wallet",null),c=Ae.get("config"),c=W(c,s),Ae.set("config",c),r.next=8,z();case 8:if(i=r.sent,Ae.set("auth/provider",i.provider),Ae.set("auth/providerModel",i.providerModel),"api"!=i.custodyModel){r.next=16;break}return r.next=14,Te(a,o);case 14:u=r.sent,u&&Ae.set("auth/wallet",a);case 16:return r.next=18,n("fetchRole");case 18:Ot.push({name:"register"});case 19:case"end":return r.stop()}}),r)})))()},disconnect:function(){return Object(x["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Ae.set("auth/wallet",null),Ot.push({name:"authentication"});case 2:case"end":return e.stop()}}),e)})))()}},H={state:F,getters:$,mutations:L,actions:G,namespaced:!0},Y=function(){return{currentBlockNumber:0,chainUpdateSubscription:null,currentWalletBalanceWei:0}},q={},X=l["d"].mutations(Y),Z={fetchAllValues:function(){return Object(x["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},subscribeToChainUpdates:function(e){var t=e.state,r=e.rootState,n=e.dispatch;t.chainUpdateSubscription&&t.chainUpdateSubscription.unsubscribe();var a=new R.a(r.auth.provider),o=a.eth.subscribe("newBlockHeaders");o.on("data",function(){var e=Object(x["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n("insertNewBlock",t);case 3:e.next=9;break;case 5:e.prev=5,e.t0=e["catch"](0),console.warn("Error on receiving a new block",e.t0),n("subscribeToChainUpdates");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()),Ae.set("nodes/chainUpdateSubscription",o)},unsubscribeToChainUpdates:function(){Y.chainUpdateSubscription&&Y.chainUpdateSubscription.unsubscribe()},insertNewBlock:function(e,t){return Object(x["a"])(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=e.rootState,a=e.commit,a("currentBlockNumber",t.number),!n.auth.wallet){r.next=7;break}return r.next=5,Ue(n.auth.wallet);case 5:o=r.sent,a("currentWalletBalanceWei",o);case 7:case"end":return r.stop()}}),r)})))()}},Q={state:Y,getters:q,mutations:X,actions:Z,namespaced:!0},ee=r("2909"),te=(r("c740"),r("4e82"),r("b64b"),r("c030").utils.keccak256),re={DRAFT:"0",READY:"1",ISSUED:"2",REPAID:"3",FROZEN:"4"},ne=new TextEncoder,ae={ADMIN:"0x0000000000000000000000000000000000000000000000000000000000000000",CAK:te(ne.encode("CAK_ROLE")),BND:te(ne.encode("BND_ROLE")),PAY:te(ne.encode("PAY_ROLE")),CUSTODIAN:te(ne.encode("CST_ROLE"))};function oe(e,t){return se.apply(this,arguments)}function se(){return se=Object(x["a"])(regeneratorRuntime.mark((function e(t,r){var n,a,o,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Xe(void 0,"RegisterStatusChanged",{},{fromBlock:t,toBlock:r});case 2:n=e.sent,a=[],o=Object(u["a"])(n);try{for(c=function(){var e=s.value,t=a.findIndex((function(t){return t.address==e.address}))>=0;t||a.push({address:e.address,name:e.returnValues.name,isin:e.returnValues.isin,block:e.blockNumber})},o.s();!(s=o.n()).done;)c()}catch(i){o.e(i)}finally{o.f()}return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)}))),se.apply(this,arguments)}function ce(){return ie.apply(this,arguments)}function ie(){return ie=Object(x["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a,o,s,c,i,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=ae.ADMIN,r=Ae.state.register.selectedRegister,r){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,Ze("RoleGranted",{role:t},{fromBlock:r.block});case 6:return n=e.sent,e.next=9,Ze("RoleRevoked",{role:t},{fromBlock:r.block});case 9:a=e.sent,o=[].concat(Object(ee["a"])(n),Object(ee["a"])(a)).sort((function(e,t){return e.blockNumber-t.blockNumber})),s=[],c=Object(u["a"])(o);try{for(l=function(){var e=i.value,t=e.returnValues.account,r=s.findIndex((function(e){return e==t}));"RoleGranted"==e.event&&-1==r&&s.push(t),"RoleRevoked"==e.event&&r>=0&&s.splice(r,1)},c.s();!(i=c.n()).done;)l()}catch(d){c.e(d)}finally{c.f()}return console.log("admin list:",o,s),e.abrupt("return",s[0]);case 16:case"end":return e.stop()}}),e)}))),ie.apply(this,arguments)}function ue(){return le.apply(this,arguments)}function le(){return le=Object(x["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ve("status");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),le.apply(this,arguments)}function de(){return pe.apply(this,arguments)}function pe(){return pe=Object(x["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a,o,s,c,i,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=ae.CAK,r=Ae.state.register.selectedRegister,r){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,Ze("RoleGranted",{role:t},{fromBlock:r.block});case 6:return n=e.sent,e.next=9,Ze("RoleRevoked",{role:t},{fromBlock:r.block});case 9:a=e.sent,o=[].concat(Object(ee["a"])(n),Object(ee["a"])(a)).sort((function(e,t){return e.blockNumber-t.blockNumber})),s=[],c=Object(u["a"])(o);try{for(l=function(){var e=i.value,t=e.returnValues.account,r=s.findIndex((function(e){return e==t}));"RoleGranted"==e.event&&-1==r&&s.push(t),"RoleRevoked"==e.event&&r>=0&&s.splice(r,1)},c.s();!(i=c.n()).done;)l()}catch(d){c.e(d)}finally{c.f()}return console.log("listCAKWallets:",o,s),e.abrupt("return",s);case 16:case"end":return e.stop()}}),e)}))),pe.apply(this,arguments)}function fe(e){return he.apply(this,arguments)}function he(){return he=Object(x["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("allow",t),e.next=3,He("grantCakRole",t);case 3:case"end":return e.stop()}}),e)}))),he.apply(this,arguments)}function ve(e){return me.apply(this,arguments)}function me(){return me=Object(x["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("revoke",t),e.next=3,He("revokeCakRole",t);case 3:case"end":return e.stop()}}),e)}))),me.apply(this,arguments)}function we(){return be.apply(this,arguments)}function be(){return be=Object(x["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,He("toggleFrozen");case 2:case"end":return e.stop()}}),e)}))),be.apply(this,arguments)}var ge=function(){return{registers:[],selectedRegister:void 0}},ke={},xe=l["d"].mutations(ge),ye={loadAll:function(e){return Object(x["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.next=3,oe(0);case 3:n=t.sent,console.log("Found registers",n),r("registers",n);case 6:case"end":return t.stop()}}),t)})))()}},Re={state:ge,getters:ke,mutations:xe,actions:ye,namespaced:!0};n["default"].use(M["a"]);var Oe={tryingToConnect:!1,mmIsOpen:!1,displaySnackbar:!1,snackbarMessage:"",snackbarColor:"error",config:void 0},je=new M["a"].Store({modules:{auth:H,nodes:Q,register:Re},plugins:[I.plugin],state:Oe,mutations:l["d"].mutations(Oe),actions:{errorFlash:function(e,t){var r=e.commit;r("snackbarMessage",t),r("snackbarColor","error"),r("displaySnackbar",!0)},fetchConfig:function(e){return Object(x["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.prev=1,n="./config.json",a=new URL(window.location.href),a.searchParams.has("config")&&(o=new URL(a.searchParams.get("config")),n=o.href,a.searchParams.delete("config")),t.next=7,fetch(n);case 7:if(s=t.sent,200!==s.status){t.next=17;break}return t.next=11,s.json();case 11:return c=t.sent,t.t0=r,t.next=15,U(c);case 15:t.t1=t.sent,(0,t.t0)("config",t.t1);case 17:t.next=22;break;case 19:t.prev=19,t.t2=t["catch"](1),r("config",void 0);case 22:case"end":return t.stop()}}),t,null,[[1,19]])})))()},connected:function(e){return Object(x["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.dispatch,r("register/loadAll");case 2:case"end":return t.stop()}}),t)})))()}}}),Ae=je,Ce=r("d4ec"),_e=r("bee2"),Me=function(){function e(t){Object(Ce["a"])(this,e),this.keyList=t||[]}return Object(_e["a"])(e,[{key:"getItem",value:function(){var e=Object(x["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(this.keyList.includes(t)||this.keyList.push(t),r=window.localStorage.getItem(t),r){e.next=6;break}return e.abrupt("return",void 0);case 6:return e.abrupt("return",JSON.parse(r));case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setItem",value:function(){var e=Object(x["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return this.keyList.includes(t)||this.keyList.push(t),r?window.localStorage.setItem(t,JSON.stringify(r)):window.localStorage.removeItem(t),e.abrupt("return");case 5:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getAll",value:function(){var e=Object(x["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t={},r=Object(u["a"])(this.keyList),e.prev=2,r.s();case 4:if((n=r.n()).done){e.next=11;break}return a=n.value,e.next=8,this.getItem(a);case 8:t[a]=e.sent;case 9:e.next=4;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](2),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:return e.abrupt("return",t);case 20:case"end":return e.stop()}}),e,this,[[2,13,16,19]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"setAll",value:function(){var e=Object(x["a"])(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=0,n=Object.keys(t);case 1:if(!(r<n.length)){e.next=8;break}return a=n[r],e.next=5,this.setItem(a,t[a]);case 5:r++,e.next=1;break;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),Ie=new Me;function Se(e){var t=new R.a(e);return t.currentProvider}function Ue(e){return Pe.apply(this,arguments)}function Pe(){return Pe=Object(x["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,new R.a(Ae.get("auth/provider")).eth.getBalance(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Pe.apply(this,arguments)}function De(e){var t=_.a.get(e);return t}function We(e,t){var r=De(e),n=r.at(t);return console.log("Instance",n),n}function Ne(e){return We("Register",e)}function Ee(e,t){return e?e.events[t]:De("Register").events[t]}function Be(){var e=Ae.get("auth/providerDirect").custodyApiUrl,t=new A["WalletCustodyApiImpl"](e,"eth");return t}function Te(e,t){return Fe.apply(this,arguments)}function Fe(){return Fe=Object(x["a"])(regeneratorRuntime.mark((function e(t,r){var n,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ie.getItem("custody.wallets");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:return n=e.t0,n.unshift(t),Ie.setItem("custody.wallets",n),a=Be(),e.next=11,Qe(a.authenticate(t,r));case 11:return o=e.sent,e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)}))),Fe.apply(this,arguments)}function $e(){return Le.apply(this,arguments)}function Le(){return Le=Object(x["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ie.getItem("custody.wallets");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)}))),Le.apply(this,arguments)}function Ke(e){if(e||(e=Ae.get("auth/provider")),!e)throw new Error("Should not be calling the api functions without a provider connected");var t=Ae.get("auth/providerModel");if("metamask"==t)return new O["Web3FunctionProvider"](e,(function(e){return Promise.resolve(e[0])}));if("direct"==t){var r=Ae.get("auth/wallet");if(r){var n=Be(),a=Ae.state.auth.walletAuthenticationFunction,o=new j["Web3CustodyFunctionProvider"](e,n,r,a);return o}return new O["Web3FunctionProvider"](e,(function(){return Promise.resolve()}))}throw new Error("should not be calling the api functions without deciding the provider (metamask or direct)")}function Ve(e){return ze.apply(this,arguments)}function ze(){return ze=Object(x["a"])(regeneratorRuntime.mark((function e(t){var r,n,a,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r=o.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=o[a];return e.abrupt("return",Je.apply(void 0,[t,{maxGas:1e7}].concat(n)));case 2:case"end":return e.stop()}}),e)}))),ze.apply(this,arguments)}function Je(e,t){return Ge.apply(this,arguments)}function Ge(){return Ge=Object(x["a"])(regeneratorRuntime.mark((function e(t,r){var n,a,o,s,c,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=Ae.get("auth/provider"),a=Ae.get("auth/contract"),t in a){e.next=4;break}return e.abrupt("return",Promise.reject(new Error("Method ".concat(t," does not exists in contract"))));case 4:for(o=i.length,s=new Array(o>2?o-2:0),c=2;c<o;c++)s[c-2]=i[c];return e.abrupt("return",a[t].apply(a,[Ke(n).call(r)].concat(s)));case 6:case"end":return e.stop()}}),e)}))),Ge.apply(this,arguments)}function He(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return qe.apply(void 0,[e,{}].concat(r))}function Ye(e){"string"!==typeof e&&(e='\n {"message":"invalid error message"}');var t=e.split("\n");1==t.length&&(t="\n ".concat(JSON.stringify({message:e})).split("\n"));try{var r=JSON.parse(t.splice(1).join(" "));return r}catch(n){return{message:"invalid JSON message"}}}function qe(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];var o=Ae.get("auth/wallet");if(!o)return Promise.reject(new Error("You are not authenticated with a wallet, you cannot update the blockchain"));var s=Ae.get("auth/provider"),c=Ae.get("auth/contract");return e in c?new Promise((function(r,a){Je.apply(void 0,[e,t].concat(n)).then(function(){var a=Object(x["a"])(regeneratorRuntime.mark((function a(o){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("Tested call",t,o),a.t0=r,a.next=4,c[e].apply(c,[Ke(s).send(t)].concat(n));case 4:a.t1=a.sent,(0,a.t0)(a.t1);case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){var t=Ye(e.message);a(t)}))})):Promise.reject(new Error("Method ".concat(e," does not exists in contract")))}function Xe(e,t,r,n){var a=n.fromBlock,o=n.toBlock,s=Ae.get("auth/provider"),c=Ee(e,t);if(!c)return Promise.resolve([]);var i=Ke(s);return new Promise((function(e,t){var n=[];c(i.get({fromBlock:a,toBlock:o}),r||{}).on("log",function(){var e=Object(x["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.push(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).on("completed",(function(){return e(n)})).on("error",t)}))}function Ze(e,t,r){var n=r.fromBlock,a=r.toBlock,o=Ae.get("auth/contract");return Xe(o,e,t,{fromBlock:n,toBlock:a})}function Qe(e,t){return et.apply(this,arguments)}function et(){return et=Object(x["a"])(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=null,e.prev=1,Ae.set("mmIsOpen",!0),e.next=5,t;case 5:n=e.sent,e.next=15;break;case 8:e.prev=8,e.t0=e["catch"](1),a=e.t0.message,e.t0.blockHash&&e.t0.gasUsed&&0==e.t0.status&&(a="Not enough gas to complete the transaction: ".concat(e.t0.gasUsed," provided")),console.warn("Submitted transaction failed with error:",a),Ae.dispatch("errorFlash",a),r&&r(e.t0);case 15:return e.prev=15,Ae.set("mmIsOpen",!1),e.finish(15);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,null,[[1,8,15,18]])}))),et.apply(this,arguments)}function tt(e){return rt.apply(this,arguments)}function rt(){return rt=Object(x["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,Ae.set("mmIsOpen",!0),e.next=4,t();case 4:e.next=10;break;case 6:e.prev=6,e.t0=e["catch"](0),console.log(e.t0),Ae.dispatch("errorFlash",e.t0.message);case 10:return e.prev=10,Ae.set("mmIsOpen",!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,6,10,13]])}))),rt.apply(this,arguments)}var nt={data:function(){return{wallet:void 0,wallets:[],networks:[],selectedNetwork:{name:"undefined"},password:"xxxxxxxx",show:!1}},mounted:function(){var e=this;return Object(x["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,$e();case 2:r=t.sent,r.length>0&&(e.wallet=r[0]),e.wallets=r,n=e.$store.get("config"),e.networks=N(n),e.selectedNetwork=D(n);case 8:case"end":return t.stop()}}),t)})))()},computed:{hasProviderMetamask:function(){return!!this.$store.state.auth.providerMetamask},hasProviderDirect:function(){return!!this.$store.state.auth.providerDirect},hasCustodyApi:function(){return!(!this.$store.state.auth.providerDirect||"api"!=this.$store.state.auth.providerDirect.custodyModel)}},methods:Object(s["a"])(Object(s["a"])({},Object(l["a"])("auth",["openMetaMaskConnectionDialog","openWeb3DirectConnectionDialog"])),{},{updateWallet:function(e){this.wallet=e},prepareOpenWeb3DirectConnectionDialog:function(){var e=this;return Object(x["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.openWeb3DirectConnectionDialog({wallet:e.wallet,password:e.password,nodeUrl:e.selectedNetwork.nodeUrl});case 2:return t.next=4,$e();case 4:e.wallets=t.sent;case 5:case"end":return t.stop()}}),t)})))()}})},at=nt,ot=Object(m["a"])(at,g,k,!1,null,null,null),st=ot.exports,ct=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-layout",{attrs:{row:"",wrap:""}},[r("v-row",[r("v-col",{staticClass:"row",attrs:{cols:"12"}},[r("v-autocomplete",{attrs:{label:"Find and select the bond register to work on",items:e.formatedRegisters,"value-comparator":function(e,t){return!(!e||!t)&&e.address==t.address},clearable:""},model:{value:e.selectedRegister,callback:function(t){e.selectedRegister=t},expression:"selectedRegister"}}),e.selectedRegister?r("explorer",{attrs:{type:"account",id:e.selectedRegister.address}}):e._e()],1),e.selectedRegister?r("v-col",{attrs:{cols:"12"}},[r("v-card",[e.userIsRegisterAdmin?r("v-card-title",{staticClass:"primary--text"},[e._v("You have the admin wallet of this register")]):r("v-card-title",{staticClass:"red--text"},[e._v("Connect with the admin wallet of this register to proceed")]),e.userIsRegisterAdmin?e._e():r("v-card-text",[e._v(e._s(e.currentAdminWallet))])],1)],1):e._e(),e.selectedRegister?r("v-col",{attrs:{cols:"12"}},[r("v-card",[r("v-card-title",[e._v("Register status: "+e._s(e.selectedRegister.statusText)+" "),r("v-spacer"),r("v-switch",{staticClass:"mr-6",attrs:{inset:"",label:"4"==e.selectedRegister.status?"Frozen":"Freeze","true-value":"4","false-value":"2"},on:{click:e.toggleFreeze},model:{value:e.selectedRegister.status,callback:function(t){e.$set(e.selectedRegister,"status",t)},expression:"selectedRegister.status"}})],1)],1)],1):e._e(),e.selectedRegister?r("v-col",{attrs:{cols:"12"}},[r("v-card",[r("v-card-title",[e._v("List of Central Account Keeper wallets")]),r("v-card-text",[r("v-data-table",{attrs:{items:e.cakWallets,headers:e.cakHeaders},scopedSlots:e._u([{key:"item.remove",fn:function(t){var n=t.item;return[r("v-btn",{attrs:{icon:""},on:{click:function(t){return e.removeWallet(n.wallet)}}},[r("v-icon",{attrs:{color:"red"}},[e._v("mdi-delete-forever")])],1)]}},{key:"foot",fn:function(){return[r("tfoot",[r("v-divider"),r("v-row",{staticClass:"px-4 align-center"},[r("v-col",{attrs:{cols:"10"}},[r("v-text-field",{attrs:{label:"Insert the wallet of a new CAK",rules:[e.ETH_ADDRESS]},model:{value:e.newCakWallet,callback:function(t){e.newCakWallet=t},expression:"newCakWallet"}})],1),r("v-col",{attrs:{cols:"2"}},[r("v-btn",{attrs:{color:"primary",small:""},on:{click:e.addWallet}},[e._v("Grant CAK role")])],1)],1)],1)]},proxy:!0}],null,!0)})],1)],1)],1):e._e()],1)],1)},it=[],ut=r("3835"),lt=(r("4fad"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-icon",{attrs:{small:"",color:"blue"},on:{click:function(t){return e.open(e.url)}}},[e._v("mdi-open-in-new")])}),dt=[],pt={props:{id:[String,Number],type:{type:String,validator:function(e){return["block","tx","token","account"].includes(e)}}},computed:{url:function(){var e=Ae.get("auth/explorerUrl");if(e){var t=new URL("".concat(e,"/").concat(this.type,"/").concat(this.id));return t.href}}},methods:{open:function(e){window.open(e,"POCR-EXPLORER")}}},ft=pt,ht=Object(m["a"])(ft,lt,dt,!1,null,null,null),vt=ht.exports,mt=(r("00b4"),r("9129"),function(e){return/^0x[a-fA-F0-9]{40}$/g.test(e)||"please make sure to enter the correct address"}),wt={components:{Explorer:vt},data:function(){return{ETH_ADDRESS:mt,cakWallets:[],cakHeaders:[{text:"Wallet",value:"wallet"},{text:"Remove",value:"remove"}],newCakWallet:null,currentAdminWallet:null}},mounted:function(){var e=this;return Object(x["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchAllValues();case 2:return t.next=4,e.subscribeToChainUpdates();case 4:case"end":return t.stop()}}),t)})))()},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["c"])("register",["registers"])),Object(l["e"])("register",["selectedRegister"])),Object(l["e"])("auth",["contract","wallet"])),{},{formatedRegisters:function(){return this.registers.map((function(e){return{text:"".concat(e.name," - ").concat(e.isin," - ").concat(e.address),value:e}}))},userIsRegisterAdmin:function(){return!!this.currentAdminWallet&&(!!this.wallet&&this.wallet.toLowerCase()==this.currentAdminWallet.toLowerCase())}}),watch:{selectedRegister:function(e,t){var r=this;return Object(x["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(console.log("Selected register changed",e,t),!e){n.next=14;break}if(!t||e.address!=t.address){n.next=4;break}return n.abrupt("return");case 4:return r.contract=Ne(e.address),n.next=7,ce();case 7:return r.currentAdminWallet=n.sent,n.next=10,r.updateRegisterStatus();case 10:return n.next=12,r.updateCAKWallet();case 12:n.next=15;break;case 14:r.contract=null;case 15:case"end":return n.stop()}}),n)})))()}},methods:Object(s["a"])(Object(s["a"])({},Object(l["a"])("nodes",["fetchAllValues","subscribeToChainUpdates"])),{},{updateCAKWallet:function(){var e=this;return Object(x["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,de();case 2:e.cakWallets=t.sent.map((function(e){return{wallet:e}}));case 3:case"end":return t.stop()}}),t)})))()},updateRegisterStatus:function(){var e=this;return Object(x["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ue();case 2:r=t.sent,n=Object.entries(re).find((function(e){var t=Object(ut["a"])(e,2),n=t[1];return n==r})),a=n?n[0]:"Undefined",console.log("updateRegisterStatus",r,re,r,a),e.selectedRegister&&(e.selectedRegister=Object(s["a"])(Object(s["a"])({},e.selectedRegister),{},{status:r,statusText:a}));case 7:case"end":return t.stop()}}),t)})))()},removeWallet:function(e){var t=this;return Object(x["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,tt((function(){return ve(e)}));case 2:return r.next=4,t.updateCAKWallet();case 4:case"end":return r.stop()}}),r)})))()},addWallet:function(){var e=this;return Object(x["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!0===mt(e.newCakWallet)){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,tt((function(){return fe(e.newCakWallet)}));case 4:return e.newCakWallet=null,t.next=7,e.updateCAKWallet();case 7:case"end":return t.stop()}}),t)})))()},toggleFreeze:function(){var e=this;return Object(x["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,tt(we);case 2:return t.next=4,e.updateRegisterStatus();case 4:case"end":return t.stop()}}),t)})))()}})},bt=wt,gt=Object(m["a"])(bt,ct,it,!1,null,null,null),kt=gt.exports;n["default"].use(d["a"]);var xt=function(e){var t=e.store;return!t.state.auth.wallet},yt=[{name:"register",path:"/register",component:kt,meta:{displayInSidenav:""}},{name:"installMetaMask",path:"/installmetamask",component:b},{name:"authentication",path:"/auth",component:st,meta:{displayInSidenav:"",hidden:function(e){var t=e.store;return!xt({store:t})}}},{path:"*",redirect:"register"}],Rt=new d["a"]({routes:yt,base:""}),Ot=Rt,jt={data:function(){return{drawer:null}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["c"])(["mmIsOpen"])),Object(l["c"])("auth",["registered"])),Object(l["c"])("status",["approved"])),{},{sidenav:function(){var e,t=this,r=yt.filter((function(e){var t;return void 0!==(null===e||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.displayInSidenav)})).map((function(e){return{icon:"mdi-wallet",label:e.name.charAt(0).toUpperCase()+e.name.slice(1),route:e.name,meta:e.meta,restricted:e.meta.restricted,disabled:function(){return t.mmIsOpen||e.meta.restricted&&!e.meta.restricted({store:t.$store})},hidden:e.meta.hidden}})),n=[],a=[],o=Object(u["a"])(r);try{for(o.s();!(e=o.n()).done;){var s=e.value;s.hidden&&s.hidden({store:this.$store})||(s.meta&&""!==s.meta.displayInSidenav&&!a.includes(s.meta.displayInSidenav)&&(n.push({subheader:!0,label:s.meta.displayInSidenav}),a.push(s.meta.displayInSidenav)),n.push(s))}}catch(c){o.e(c)}finally{o.f()}return n}}),mounted:function(){console.log("routes",yt)},methods:{goTo:function(e){this.$route.name!==e&&this.$router.push({name:e})}}},At=jt,Ct=Object(m["a"])(At,c,i,!1,null,null,null),_t=Ct.exports,Mt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{width:"500",persistent:""},model:{value:e.display,callback:function(t){e.display=t},expression:"display"}},[r("v-card",[r("v-card-title",[e._v("Transaction authentication")]),r("v-card-text",[e._v(" Enter the password for the wallet "+e._s(e.walletAddress)+" : "),r("v-text-field",{attrs:{type:"password"},model:{value:e.walletPassword,callback:function(t){e.walletPassword=t},expression:"walletPassword"}}),r("div",{staticStyle:{color:"red"}},[e._v(e._s(e.errorMessage))])],1),r("v-card-actions",[r("v-btn",{on:{click:e.cancel}},[e._v("Cancel")]),r("v-btn",{attrs:{loading:e.loading,disabled:""===e.walletPassword||e.loading},on:{click:e.submit}},[e._v(" Confirm ")])],1)],1)],1)},It=[],St={data:function(){return{walletAddress:null,errorMessage:null,display:!1,loading:!1,walletPassword:"",submit:function(){},cancel:function(){}}},methods:{authenticate:function(e,t){var r=this;return Object(x["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e&&t){n.next=2;break}throw new Error("Invalid call to the authenticate function, missing parameters");case 2:return r.walletAddress=e,r.display=!0,n.prev=4,n.next=7,new Promise((function(e,n){function a(){return o.apply(this,arguments)}function o(){return o=Object(x["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!this.walletAddress||!this.walletPassword){r.next=19;break}return this.loading=!0,r.prev=2,r.next=5,t.authenticate(this.walletAddress,this.walletPassword);case 5:if(a=r.sent,a){r.next=8;break}throw new Error("Missing token from authenticate without real error");case 8:e(a),r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](2),this.errorMessage=r.t0.message;case 14:return r.prev=14,this.loading=!1,r.finish(14);case 17:r.next=20;break;case 19:n(new Error("No wallet address or password"));case 20:case"end":return r.stop()}}),r,this,[[2,11,14,17]])}))),o.apply(this,arguments)}function s(){n(new Error("Authentication cancelled by user"))}r.submit=a.bind(r),r.cancel=s.bind(r)}));case 7:return a=n.sent,n.abrupt("return",a);case 9:return n.prev=9,r.walletPassword="",r.errorMessage=null,r.display=!1,n.finish(9);case 14:case"end":return n.stop()}}),n,null,[[4,,9,14]])})))()}}},Ut=St,Pt=Object(m["a"])(Ut,Mt,It,!1,null,null,null),Dt=Pt.exports,Wt={components:{AppMenu:_t,WalletAuthenticationDialog:Dt},data:function(){return{}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["e"])(["displaySnackbar","snackbarMessage","snackbarColor"])),Object(l["c"])(["mmIsOpen"])),Object(l["c"])("auth",["wallet"])),methods:Object(s["a"])({},Object(l["a"])("auth",["detectProvider","disconnect"])),mounted:function(){Ae.set("auth/walletAuthenticationFunction",this.$refs.walletAuthenticationDialog.authenticate)}},Nt=Wt,Et=Object(m["a"])(Nt,a,o,!1,null,null,null),Bt=Et.exports,Tt=r("ce5b"),Ft=r.n(Tt);r("bf40");n["default"].use(Ft.a);var $t=function(e){return new Ft.a({theme:{themes:{light:null!==e&&void 0!==e?e:{primary:"#607d8b",secondary:"#009688",accent:"#4caf50",error:"# e91e63",warning:"#cddc39",info:"#3f51b5",success:"#8bc34"}}}})};r("d5e8"),r("5363");function Lt(e,t){e.beforeEach(function(){var e=Object(x["a"])(regeneratorRuntime.mark((function e(r,n,a){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("routing ",n.name,r.name),"installMetaMask"!==r.name){e.next=3;break}return e.abrupt("return",a());case 3:if(t.state.auth.providerModel){e.next=13;break}return console.log("no auth provider yet"),e.next=7,t.dispatch("auth/detectProvider");case 7:if(console.log("Didn't find any provider in the app, trying to detect one. Provider found?",t.state.auth.providerModel,t.state.auth.provider),"both"!=t.state.auth.providerModel){e.next=10;break}return e.abrupt("return",a({name:"authentication"}));case 10:if("metamask"==t.state.auth.providerModel&&t.dispatch("auth/openMetaMaskConnectionDialog"),t.state.auth.provider){e.next=13;break}return e.abrupt("return",a({name:"installMetaMask"}));case 13:if(r.meta&&r.meta.restricted){e.next=15;break}return e.abrupt("return",a());case 15:if(t.state.auth.wallet){e.next=21;break}return console.log("Didn't find the wallet in the app. Trying to fetch it..."),e.next=19,t.dispatch("auth/attemptToConnectWallet");case 19:o=e.sent,console.log("Found a connected wallet.",o);case 21:if(r.meta.restricted({store:t})){e.next=28;break}return console.log("Didn't find the proper authorizations to go to this route. Checking again with the smart contract..."),e.next=25,Promise.all([t.dispatch("auth/fetchIsRegistered"),t.dispatch("status/fetchIsApproved"),t.dispatch("auth/fetchRole")]);case 25:if(r.meta.restricted({store:t})){e.next=27;break}return e.abrupt("return",a({name:r.meta.forceRedirectTo}));case 27:console.log("Found the proper authorizations.");case 28:return e.abrupt("return",a());case 29:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}())}n["default"].config.productionTip=!1,Lt(Ot,Ae),new n["default"]({vuetify:$t({primary:"#4d0773"}),store:Ae,router:Ot,render:function(e){return e(Bt)}}).$mount("#app")},6:function(e,t){},7:function(e,t){},8:function(e,t){},9:function(e,t){}});
//# sourceMappingURL=index.02327110.js.map